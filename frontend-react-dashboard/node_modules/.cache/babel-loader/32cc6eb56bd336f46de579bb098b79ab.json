{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/ui.scheduler.appointment.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (\"function\" === typeof Symbol && \"symbol\" === typeof Symbol.iterator) {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && \"function\" === typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar _renderer = require(\"../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _events_engine = require(\"../../events/core/events_engine\");\n\nvar _events_engine2 = _interopRequireDefault(_events_engine);\n\nvar _translator = require(\"../../animation/translator\");\n\nvar _translator2 = _interopRequireDefault(_translator);\n\nvar _utils = require(\"./utils.recurrence\");\n\nvar _utils2 = _interopRequireDefault(_utils);\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _component_registrator = require(\"../../core/component_registrator\");\n\nvar _component_registrator2 = _interopRequireDefault(_component_registrator);\n\nvar _ui = require(\"../tooltip/ui.tooltip\");\n\nvar _ui2 = _interopRequireDefault(_ui);\n\nvar _uiScheduler = require(\"./ui.scheduler.publisher_mixin\");\n\nvar _uiScheduler2 = _interopRequireDefault(_uiScheduler);\n\nvar _utils3 = require(\"../../events/utils\");\n\nvar eventUtils = _interopRequireWildcard(_utils3);\n\nvar _pointer = require(\"../../events/pointer\");\n\nvar _pointer2 = _interopRequireDefault(_pointer);\n\nvar _dom_component = require(\"../../core/dom_component\");\n\nvar _dom_component2 = _interopRequireDefault(_dom_component);\n\nvar _resizable = require(\"../resizable\");\n\nvar _resizable2 = _interopRequireDefault(_resizable);\n\nvar _message = require(\"../../localization/message\");\n\nvar _message2 = _interopRequireDefault(_message);\n\nvar _date = require(\"../../localization/date\");\n\nvar _date2 = _interopRequireDefault(_date);\n\nvar _constants = require(\"./constants\");\n\nfunction _getRequireWildcardCache() {\n  if (\"function\" !== typeof WeakMap) {\n    return null;\n  }\n\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (null === obj || \"object\" !== _typeof(obj) && \"function\" !== typeof obj) {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar DEFAULT_HORIZONTAL_HANDLES = \"left right\";\nvar DEFAULT_VERTICAL_HANDLES = \"top bottom\";\nvar REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME = eventUtils.addNamespace(_pointer2.default.enter, \"dxSchedulerAppointment\");\nvar REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME = eventUtils.addNamespace(_pointer2.default.leave, \"dxSchedulerAppointment\");\n\nvar Appointment = _dom_component2.default.inherit({\n  _getDefaultOptions: function _getDefaultOptions() {\n    return (0, _extend.extend)(this.callBase(), {\n      data: {},\n      geometry: {\n        top: 0,\n        left: 0,\n        width: 0,\n        height: 0\n      },\n      allowDrag: true,\n      allowResize: true,\n      reduced: null,\n      isCompact: false,\n      direction: \"vertical\",\n      resizableConfig: {},\n      cellHeight: 0,\n      cellWidth: 0\n    });\n  },\n  _optionChanged: function _optionChanged(args) {\n    switch (args.name) {\n      case \"data\":\n      case \"geometry\":\n      case \"allowDrag\":\n      case \"allowResize\":\n      case \"reduced\":\n      case \"sortedIndex\":\n      case \"isCompact\":\n      case \"direction\":\n      case \"resizableConfig\":\n      case \"cellHeight\":\n      case \"cellWidth\":\n        this._invalidate();\n\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  _getHorizontalResizingRule: function _getHorizontalResizingRule() {\n    var reducedHandles = {\n      head: this.option(\"rtlEnabled\") ? \"right\" : \"left\",\n      body: \"\",\n      tail: this.option(\"rtlEnabled\") ? \"left\" : \"right\"\n    };\n    return {\n      handles: this.option(\"reduced\") ? reducedHandles[this.option(\"reduced\")] : DEFAULT_HORIZONTAL_HANDLES,\n      minHeight: 0,\n      minWidth: this.invoke(\"getCellWidth\"),\n      step: this.invoke(\"getResizableStep\")\n    };\n  },\n  _getVerticalResizingRule: function _getVerticalResizingRule() {\n    var height = this.invoke(\"getCellHeight\");\n    return {\n      handles: DEFAULT_VERTICAL_HANDLES,\n      minWidth: 0,\n      minHeight: height,\n      step: height\n    };\n  },\n  _render: function _render() {\n    this.callBase();\n\n    this._renderAppointmentGeometry();\n\n    this._renderEmptyClass();\n\n    this._renderReducedAppointment();\n\n    this._renderAllDayClass();\n\n    this._renderDirection();\n\n    this.$element().data(\"dxAppointmentStartDate\", this.option(\"startDate\"));\n    this.$element().attr(\"title\", this.invoke(\"getField\", \"text\", this.option(\"data\")));\n    this.$element().attr(\"role\", \"button\");\n\n    this._renderRecurrenceClass();\n\n    this._renderResizable();\n  },\n  _renderAppointmentGeometry: function _renderAppointmentGeometry() {\n    var geometry = this.option(\"geometry\");\n    var $element = this.$element();\n\n    _translator2.default.move($element, {\n      top: geometry.top,\n      left: geometry.left\n    });\n\n    $element.css({\n      width: geometry.width < 0 ? 0 : geometry.width,\n      height: geometry.height < 0 ? 0 : geometry.height\n    });\n  },\n  _renderEmptyClass: function _renderEmptyClass() {\n    var geometry = this.option(\"geometry\");\n\n    if (geometry.empty || this.option(\"isCompact\")) {\n      this.$element().addClass(_constants.EMPTY_APPOINTMENT_CLASS);\n    }\n  },\n  _renderReducedAppointment: function _renderReducedAppointment() {\n    var reducedPart = this.option(\"reduced\");\n\n    if (!reducedPart) {\n      return;\n    }\n\n    this.$element().toggleClass(_constants.REDUCED_APPOINTMENT_CLASS, true).toggleClass(_constants.REDUCED_APPOINTMENT_PARTS_CLASSES[reducedPart], true);\n\n    this._renderAppointmentReducedIcon();\n  },\n  _renderAppointmentReducedIcon: function _renderAppointmentReducedIcon() {\n    var $icon = (0, _renderer2.default)(\"<div>\").addClass(_constants.REDUCED_APPOINTMENT_ICON).appendTo(this.$element());\n\n    var endDate = this._getEndDate();\n\n    var tooltipLabel = _message2.default.format(\"dxScheduler-editorLabelEndDate\");\n\n    var tooltipText = [tooltipLabel, \": \", _date2.default.format(endDate, \"monthAndDay\"), \", \", _date2.default.format(endDate, \"year\")].join(\"\");\n\n    _events_engine2.default.off($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME);\n\n    _events_engine2.default.on($icon, REDUCED_APPOINTMENT_POINTERENTER_EVENT_NAME, function () {\n      _ui2.default.show({\n        target: $icon,\n        content: tooltipText\n      });\n    });\n\n    _events_engine2.default.off($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME);\n\n    _events_engine2.default.on($icon, REDUCED_APPOINTMENT_POINTERLEAVE_EVENT_NAME, function () {\n      _ui2.default.hide();\n    });\n  },\n  _getEndDate: function _getEndDate() {\n    var result = this.invoke(\"getField\", \"endDate\", this.option(\"data\"));\n\n    if (result) {\n      return new Date(result);\n    }\n\n    return result;\n  },\n  _renderAllDayClass: function _renderAllDayClass() {\n    this.$element().toggleClass(_constants.ALL_DAY_APPOINTMENT_CLASS, !!this.option(\"allDay\"));\n  },\n  _renderRecurrenceClass: function _renderRecurrenceClass() {\n    var rule = this.invoke(\"getField\", \"recurrenceRule\", this.option(\"data\"));\n\n    if (_utils2.default.getRecurrenceRule(rule).isValid) {\n      this.$element().addClass(_constants.RECURRENCE_APPOINTMENT_CLASS);\n    }\n  },\n  _renderDirection: function _renderDirection() {\n    this.$element().addClass(_constants.DIRECTION_APPOINTMENT_CLASSES[this.option(\"direction\")]);\n  },\n  _createResizingConfig: function _createResizingConfig() {\n    var config = \"vertical\" === this.option(\"direction\") ? this._getVerticalResizingRule() : this._getHorizontalResizingRule();\n    config.roundStepValue = true;\n\n    if (!this.invoke(\"isGroupedByDate\")) {\n      config.stepPrecision = \"strict\";\n    }\n\n    return config;\n  },\n  _renderResizable: function _renderResizable() {\n    if (this.option(\"allowResize\")) {\n      this._createComponent(this.$element(), _resizable2.default, (0, _extend.extend)(this._createResizingConfig(), this.option(\"resizableConfig\")));\n    }\n  },\n  _useTemplates: function _useTemplates() {\n    return false;\n  }\n}).include(_uiScheduler2.default);\n\n(0, _component_registrator2.default)(\"dxSchedulerAppointment\", Appointment);\nmodule.exports = Appointment;","map":null,"metadata":{},"sourceType":"script"}