{"ast":null,"code":"/**\r\n * DevExtreme (ui/scheduler/tooltip_strategies/tooltipStrategyBase.js)\r\n * Version: 20.1.7\r\n * Build date: Tue Aug 25 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.TooltipStrategyBase = void 0;\n\nvar _button = require(\"../../button\");\n\nvar _button2 = _interopRequireDefault(_button);\n\nvar _function_template = require(\"../../../core/templates/function_template\");\n\nvar _renderer = require(\"../../../core/renderer\");\n\nvar _renderer2 = _interopRequireDefault(_renderer);\n\nvar _uiList = require(\"../../list/ui.list.edit\");\n\nvar _uiList2 = _interopRequireDefault(_uiList);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar TOOLTIP_APPOINTMENT_ITEM = \"dx-tooltip-appointment-item\";\nvar TOOLTIP_APPOINTMENT_ITEM_CONTENT = TOOLTIP_APPOINTMENT_ITEM + \"-content\";\nvar TOOLTIP_APPOINTMENT_ITEM_CONTENT_SUBJECT = TOOLTIP_APPOINTMENT_ITEM + \"-content-subject\";\nvar TOOLTIP_APPOINTMENT_ITEM_CONTENT_DATE = TOOLTIP_APPOINTMENT_ITEM + \"-content-date\";\nvar TOOLTIP_APPOINTMENT_ITEM_MARKER = TOOLTIP_APPOINTMENT_ITEM + \"-marker\";\nvar TOOLTIP_APPOINTMENT_ITEM_MARKER_BODY = TOOLTIP_APPOINTMENT_ITEM + \"-marker-body\";\nvar TOOLTIP_APPOINTMENT_ITEM_DELETE_BUTTON_CONTAINER = TOOLTIP_APPOINTMENT_ITEM + \"-delete-button-container\";\nvar TOOLTIP_APPOINTMENT_ITEM_DELETE_BUTTON = TOOLTIP_APPOINTMENT_ITEM + \"-delete-button\";\n\nvar TooltipStrategyBase = exports.TooltipStrategyBase = function () {\n  function TooltipStrategyBase(options) {\n    _classCallCheck(this, TooltipStrategyBase);\n\n    this._tooltip = null;\n    this._options = options;\n    this._extraOptions = null;\n  }\n\n  _createClass(TooltipStrategyBase, [{\n    key: \"show\",\n    value: function value(target, dataList, extraOptions) {\n      if (this._canShowTooltip(dataList)) {\n        this.hide();\n        this._extraOptions = extraOptions;\n\n        this._showCore(target, dataList);\n      }\n    }\n  }, {\n    key: \"_showCore\",\n    value: function value(target, dataList) {\n      if (!this._tooltip) {\n        this._tooltip = this._createTooltip(target, dataList);\n      } else {\n        this._shouldUseTarget() && this._tooltip.option(\"target\", target);\n\n        this._list.option(\"dataSource\", dataList);\n      }\n\n      this._prepareBeforeVisibleChanged(dataList);\n\n      this._tooltip.option(\"visible\", true);\n    }\n  }, {\n    key: \"_prepareBeforeVisibleChanged\",\n    value: function value(dataList) {}\n  }, {\n    key: \"_getContentTemplate\",\n    value: function value(dataList) {\n      var _this = this;\n\n      return function (container) {\n        var listElement = (0, _renderer2.default)(\"<div>\");\n        (0, _renderer2.default)(container).append(listElement);\n        _this._list = _this._createList(listElement, dataList);\n      };\n    }\n  }, {\n    key: \"isAlreadyShown\",\n    value: function value(target) {\n      if (this._tooltip && this._tooltip.option(\"visible\")) {\n        return this._tooltip.option(\"target\")[0] === target[0];\n      }\n    }\n  }, {\n    key: \"_onShown\",\n    value: function value() {\n      this._list.option(\"focusStateEnabled\", this._extraOptions.focusStateEnabled);\n    }\n  }, {\n    key: \"dispose\",\n    value: function value() {}\n  }, {\n    key: \"hide\",\n    value: function value() {\n      if (this._tooltip) {\n        this._tooltip.option(\"visible\", false);\n      }\n    }\n  }, {\n    key: \"_shouldUseTarget\",\n    value: function value() {\n      return true;\n    }\n  }, {\n    key: \"_createTooltip\",\n    value: function value() {}\n  }, {\n    key: \"_canShowTooltip\",\n    value: function value(dataList) {\n      if (!dataList.length) {\n        return false;\n      }\n\n      return true;\n    }\n  }, {\n    key: \"_createListOption\",\n    value: function value(dataList) {\n      var _this2 = this;\n\n      return {\n        dataSource: dataList,\n        onContentReady: this._onListRender.bind(this),\n        onItemClick: function onItemClick(e) {\n          return _this2._onListItemClick(e);\n        },\n        itemTemplate: function itemTemplate(item, index) {\n          return _this2._renderTemplate(item.data, _this2._getCurrentAppointmentData(item), index, item.color);\n        }\n      };\n    }\n  }, {\n    key: \"_onListRender\",\n    value: function value() {}\n  }, {\n    key: \"_createTooltipElement\",\n    value: function value(wrapperClass) {\n      return (0, _renderer2.default)(\"<div>\").appendTo(this._options.container).addClass(wrapperClass);\n    }\n  }, {\n    key: \"_createList\",\n    value: function value(listElement, dataList) {\n      return this._options.createComponent(listElement, _uiList2.default, this._createListOption(dataList));\n    }\n  }, {\n    key: \"_renderTemplate\",\n    value: function value(data, currentData, index, color) {\n      var itemListContent = this._createItemListContent(data, currentData, color);\n\n      this._options.addDefaultTemplates(_defineProperty({}, this._getItemListTemplateName(), new _function_template.FunctionTemplate(function (options) {\n        var $container = (0, _renderer2.default)(options.container);\n        $container.append(itemListContent);\n        return $container;\n      })));\n\n      var template = this._options.getAppointmentTemplate(this._getItemListTemplateName() + \"Template\");\n\n      return this._createFunctionTemplate(template, data, currentData, index);\n    }\n  }, {\n    key: \"_createFunctionTemplate\",\n    value: function value(template, data, targetData, index) {\n      var isEmptyDropDownAppointmentTemplate = this._isEmptyDropDownAppointmentTemplate();\n\n      return new _function_template.FunctionTemplate(function (options) {\n        return template.render({\n          model: isEmptyDropDownAppointmentTemplate ? {\n            appointmentData: data,\n            targetedAppointmentData: targetData\n          } : data,\n          container: options.container,\n          index: index\n        });\n      });\n    }\n  }, {\n    key: \"_getItemListTemplateName\",\n    value: function value() {\n      return this._isEmptyDropDownAppointmentTemplate() ? \"appointmentTooltip\" : \"dropDownAppointment\";\n    }\n  }, {\n    key: \"_isEmptyDropDownAppointmentTemplate\",\n    value: function value() {\n      return !this._extraOptions.dropDownAppointmentTemplate || \"dropDownAppointment\" === this._extraOptions.dropDownAppointmentTemplate;\n    }\n  }, {\n    key: \"_onListItemClick\",\n    value: function value(e) {\n      this.hide();\n      this._extraOptions.clickEvent && this._extraOptions.clickEvent(e);\n\n      this._options.showAppointmentPopup(e.itemData.data, false, this._getCurrentAppointmentData(e.itemData));\n    }\n  }, {\n    key: \"_getCurrentAppointmentData\",\n    value: function value(item) {\n      return item.settings && item.settings.targetedAppointmentData || item.currentData || item.data;\n    }\n  }, {\n    key: \"_createItemListContent\",\n    value: function value(data, currentData, color) {\n      var editing = this._extraOptions.editing;\n      var $itemElement = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM);\n      $itemElement.append(this._createItemListMarker(color));\n      $itemElement.append(this._createItemListInfo(this._options.getTextAndFormatDate(data, currentData)));\n\n      if (!data.disabled && (editing && true === editing.allowDeleting || true === editing)) {\n        var singleAppointmentData = this._options.getSingleAppointmentData(data, this._tooltip.option(\"target\"));\n\n        $itemElement.append(this._createDeleteButton(data, singleAppointmentData));\n      }\n\n      return $itemElement;\n    }\n  }, {\n    key: \"_createItemListMarker\",\n    value: function value(color) {\n      var $marker = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM_MARKER);\n      var $markerBody = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM_MARKER_BODY);\n      $marker.append($markerBody);\n      color && color.done(function (value) {\n        return $markerBody.css(\"background\", value);\n      });\n      return $marker;\n    }\n  }, {\n    key: \"_createItemListInfo\",\n    value: function value(object) {\n      var result = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM_CONTENT);\n      var $title = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM_CONTENT_SUBJECT).text(object.text);\n      var $date = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM_CONTENT_DATE).text(object.formatDate);\n      return result.append($title).append($date);\n    }\n  }, {\n    key: \"_createDeleteButton\",\n    value: function value(data, currentData) {\n      var _this3 = this;\n\n      var $container = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM_DELETE_BUTTON_CONTAINER);\n      var $deleteButton = (0, _renderer2.default)(\"<div>\").addClass(TOOLTIP_APPOINTMENT_ITEM_DELETE_BUTTON);\n      $container.append($deleteButton);\n\n      this._options.createComponent($deleteButton, _button2.default, {\n        icon: \"trash\",\n        stylingMode: \"text\",\n        onClick: function onClick(e) {\n          _this3.hide();\n\n          e.event.stopPropagation();\n\n          _this3._options.checkAndDeleteAppointment(data, currentData);\n        }\n      });\n\n      return $container;\n    }\n  }]);\n\n  return TooltipStrategyBase;\n}();","map":null,"metadata":{},"sourceType":"script"}